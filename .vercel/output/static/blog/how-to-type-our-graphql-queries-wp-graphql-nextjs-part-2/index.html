<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="Astro v2.4.2">
    <title>How to type our GraphQL queries (WP GraphQL + Next.js, part 2)</title>



<link rel="canonical" href="http://localhost:3000/blog/how-to-type-our-graphql-queries-wp-graphql-nextjs-part-2/">

<meta name="description" content="How to create a JAMstack static site using headless WordPress, Next.js and GraphQL, part 2: How to type our queries with TypeScript">

<meta name="robots" content="index, follow">

<meta property="og:title" content="How to type our GraphQL queries (WP GraphQL + Next.js, part 2)">
<meta property="og:type" content="article">
<meta property="og:image" content="https://user-images.githubusercontent.com/5182256/131216951-8f74f425-f775-463d-a11b-0e01ad9fce8d.png">
<meta property="og:url" content="http://localhost:3000/blog/how-to-type-our-graphql-queries-wp-graphql-nextjs-part-2/">









<meta name="twitter:creator" content="@SvachaHynek">

<meta content="WordPress,Next.js,GraphQL,TypeScript" name="keywords"><meta content="Hynek Svacha" name="author"><meta content="Hynek Svacha" name="article:author"><meta content="Nov 15, 2021 17:21" name="article:published_time"><meta content="wordpress,nextjs,graphql,typescript" name="article:tag"><meta content="https://user-images.githubusercontent.com/5182256/131216951-8f74f425-f775-463d-a11b-0e01ad9fce8d.png" name="twitter:image"><meta content="How to type our GraphQL queries (WP GraphQL + Next.js, part 2)" name="twitter:title"><meta content="How to create a JAMstack static site using headless WordPress, Next.js and GraphQL, part 2: How to type our queries with TypeScript" name="twitter:description">
    <link rel="preload" href="/assets/fonts/Nunito[wght]-subset.woff2" as="font" crossorigin="anonymous">
    <link rel="preload" href="/assets/fonts/Nunito-Italic[wght]-subset.woff2" as="font" crossorigin="anonymous">

    <link rel="stylesheet" href="/assets/styles/base.css">

    <link rel="icon" type="image/svg+xml" href="/assets/favicons/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicons/site.webmanifest">
    <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5">

    <script>
      const theme = (() => {
        if (
          typeof localStorage !== "undefined" &&
          localStorage.getItem("theme")
        ) {
          return localStorage.getItem("theme");
        }
        if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
          return "dark";
        }
        return "light";
      })();
      if (theme === "light") {
        document.documentElement.classList.remove("dark");
      } else {
        document.documentElement.classList.add("dark");
      }
    </script>
  <link rel="stylesheet" href="/_astro/index.6eb0b711.css" /><script type="module">
</script><link rel="stylesheet" href="/_astro/RecursiveList.astro_astro_type_style_index_0_lang.341da06d.css" /><script src="/_astro/RecursiveList.astro_astro_type_script_index_0_lang.386d38c4.js" type="module"></script><script src="/_astro/Footer.astro_astro_type_script_index_0_lang.70efab02.js" type="module"></script></head>
  <body>
    <header class="top-0 flex justify-between pr-6 pl-4 pt-6 pb-4 w-full mb-8 h-[4.5rem] /* added explicit height and width to fight the layout shift*/ lg:pl-[2.25rem] lg:sticky">
  <div>
    <div class="flex items-end gap-4 -mt-1.5">
      <a href="/" aria-label="Link to homepage" class="mr-4">
        <div class="flex items-end gap-2">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 dark:opacity-[0.85]" viewBox="0 0 64 64" xml:space="preserve">
    <path fill="#865DDE" d="M0 0h64v64H0z"></path>
    <g fill="#FFF">
      <path d="M12.69 27.582h6.697v11.286h8.764V27.582h6.697v30.219h-6.697V44.737h-8.764V57.8H12.69V27.582zM43.229 48.789c1.735 2.852 3.431 4.175 5.869 4.175 2.315 0 3.804-1.363 3.804-3.183 0-1.654-1.075-2.894-3.349-3.846-2.976-1.239-5.58-2.107-7.482-3.596-2.108-1.653-3.183-3.969-3.183-6.779 0-5.333 3.762-8.765 9.797-8.765 4.383 0 7.73 1.819 9.88 5.333L53.77 35.56c-1.612-2.274-3.391-3.391-5.457-3.391s-3.349 1.158-3.349 2.771c0 1.529 1.198 2.646 3.639 3.72 3.059 1.323 5.746 2.191 7.565 3.639 2.025 1.611 3.183 4.051 3.183 6.986 0 5.498-4.134 9.301-10.418 9.301-4.753 0-8.392-2.066-10.914-6.118l5.21-3.679z"></path>
    </g>
  </svg>
  <span class="font-bold text-gray-900 dark:text-primary mt-auto leading-none pb-0.5">HynekS</span>
</div>
      </a>
      <div class="flex pt-3 relative top-1 leading-none gap-4 [&>a]:font-medium [&>a]:pb-1 [&>a]:border-b-2 [&>a]:border-transparent [&>a.active]:border-b-2 [&>a.active]:[border-color:var(--color-primary)]">
        <a href="/" class="active">blog</a>
        <a href="/projects" class="">projects</a>
        <a href="/about" class="">about</a>
      </div>
    </div>
  </div>
  <div>
    <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).load=a=>{(async()=>await(await a())())()},window.dispatchEvent(new Event("astro:load"));var l;{const c={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(JSON.parse(t)),9:t=>new Uint16Array(JSON.parse(t)),10:t=>new Uint32Array(JSON.parse(t))},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,n]=s;return e in c?c[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(l=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement&&this.parentElement.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(const r of n){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(const r of s){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML)}const a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((s,e)=>{e.disconnect(),this.childrenConnectedCallback()}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate);let s=this.getAttribute("before-hydration-url");s&&await import(s),this.start()}start(){const s=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{const n=this.getAttribute("renderer-url"),[a,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(const d of i.split("."))this.Component=this.Component[d]}return this.hydrator=r,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},l.observedAttributes=["props"],l))}</script><astro-island uid="ZonHg9" component-url="/_astro/ThemeToggle.32d5cae3.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}" await-children=""><button aria-label="Toggle Dark Mode" type="button" class="rounded-full flex items-center justify-center border-2 p-1 focus:outline-none focus:ring-0 dark:border-gray-600"><svg class="w-6 h-6" fill="none" stroke="var(--color-primary)" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></button></astro-island>
  </div>
</header>
    
  <aside class="hidden md:block md:w-1/5">
    

<nav data-is_navigation>
  <ul>
        <li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#overview">
    Overview
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#prerequisites">
    Prerequisites
  </a>
  <ul>
        <li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#wordpress">
    WordPress
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#nextjs">
    Next.js
  </a>
  
</li>
      </ul>
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#install-and-initialize-the-graphql-code-generator">
    Install and initialize the GraphQL code generator
  </a>
  <ul>
        <li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#install-the-core-modules">
    Install the core modules
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#initialize-the-code-generator">
    Initialize the code generator
  </a>
  
</li>
      </ul>
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#turn-graphql-introspection-on-in-wp-graphql-plugin-settings">
    Turn GraphQL introspection ON in WP GraphQL plugin settings
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#add-the-graphql-tag-plucks">
    Add the GraphQL Tag Plucks
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#update-the-gitignore-file">
    Update the .gitignore file
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#run-the-codegen-script">
    Run the codegen script
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#utilize-the-types-in-our-api">
    Utilize the types in our api
  </a>
  <ul>
        <li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#import-and-arrange-types-for-our-queries">
    Import and arrange types for our queries
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#add-types-to-the-fetchapi-function">
    Add types to the FetchApi function
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#add-types-for-our-queries">
    Add types for our queries
  </a>
  
</li>
      </ul>
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#utilize-the-types-in-our-templates">
    Utilize the types in our templates
  </a>
  <ul>
        <li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#import-and-apply-our-types">
    Import and apply our types
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#update-our-component-to-make-typescript-happy">
    Update our component to make TypeScript happy
  </a>
  
</li><li>
  <svg xmlns="http://www.w3.org/2000/svg" class="p-[0.75px]" viewBox="0 0 2 12">
    <path fill="currentColor" d="M2 11c0 .552-.448 1-1 1s-1-.448-1-1V1c0-.552.448-1 1-1s1 .448 1 1v10z"></path>
  </svg>
  <a href="#the-slugtsx-template">
    The [slug].tsx template
  </a>
  
</li>
      </ul>
</li>
      </ul>
</nav>
  </aside>
  <main class="flex-auto max-w-full [margin-right:calc((50% - 30ch)/2)]">
    <article class="prose prose-sm mx-auto pt-8 px-4 md:prose lg:prose-lg lg:px-0 dark:prose-dark pb-16" data-is_article>
      <h1 id="overview">How to type our GraphQL queries (WP GraphQL + Next.js, part 2)</h1>
      <div class="not-prose font-mono text-sm dark:text-gray-400">
        <ul class="flex gap-1.5 mt-0 mb-1 ml--1 py-2">
              <li class="font-mono leading-none text-[0.6875rem] rounded-md py-[0.2rem] px-[0.25rem] dark:[filter:brightness(1.25)] flex items-center" style="background-color: rgba(0, 116, 156, 0.25); border: 1px solid rgba(0, 116, 156, 0.3);"><span>wordpress</span></li><li class="font-mono leading-none text-[0.6875rem] rounded-md py-[0.2rem] px-[0.25rem] dark:[filter:brightness(1.25)] flex items-center" style="background-color: rgba(102, 102, 102, 0.25); border: 1px solid rgba(102, 102, 102, 0.3);"><span>nextjs</span></li><li class="font-mono leading-none text-[0.6875rem] rounded-md py-[0.2rem] px-[0.25rem] dark:[filter:brightness(1.25)] flex items-center" style="background-color: rgba(228, 52, 170, 0.25); border: 1px solid rgba(228, 52, 170, 0.3);"><span>graphql</span></li><li class="font-mono leading-none text-[0.6875rem] rounded-md py-[0.2rem] px-[0.25rem] dark:[filter:brightness(1.25)] flex items-center" style="background-color: rgba(49, 120, 198, 0.25); border: 1px solid rgba(49, 120, 198, 0.3);"><span>typescript</span></li>
            </ul>
        posted <span>on </span><span>15<sup>th</sup> November 2021</span> ∙ by Hynek Svacha ∙
        12 min read
      </div>
      
<p>This is the second part of the ’<em>Create a Next.js static site with Wordpress and GraphQL</em>’ tutorial. In the <a href="https://github.com/HynekS/wp-next-graphql-tutorial">first part</a>, we learned how to connect WordPress (as a ‘backend’) and Next.js (as a ‘frontend’) using GraphQL queries and how to export our app as a static site. In this part, we will learn how to <em>type our queries</em> with TypeScript.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>The prerequisites are the same as in the<a href="https://github.com/HynekS/wp-next-graphql-tutorial">first part</a>. If you’ve already finished it, you can <a href="#install-and-initialize-graphql-code-generator">skip that part</a>. If you don’t want to follow the first tutorial, you can clone the github repo as a starting point:</p>
<div class="remark-highlight"><astro-island uid="Z2rOM6I" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-bash&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-bash"><astro-slot>
  <code class="language-bash"><span class="token function">git</span> clone --recurse-submodules https://github.com/HynekS/wp-next-graphql-tutorial/
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>You will also need to set up a few more things, though:</p>
<h3 id="wordpress">WordPress</h3>
<p>You will need to create a database for WordPress. In the <code>/bedrock</code> directory, you’ll need to rename the <code>.env.example</code> file to <code>.env</code>. In the <code>.env</code> file, you’ll need to update your database credentials and the base url of the site. For installing all dependencies, you’ll need to run <code>composer install --no-scripts</code> command. You’ll need to activate the ’<strong>WP GraphQL</strong>’ plugin and flush permalinks (Settings -&gt; Permalinks, Save Changes). It’s probably a good idea to create a few posts using <strong>Faker Press</strong> plugin (or manually, if you feel like it). For more details, check out the <a href="https://github.com/HynekS/wp-next-graphql-tutorial">first part</a>.</p>
<h3 id="nextjs">Next.js</h3>
<p>In the <code>/nextjs</code> folder, run <code>yarn install</code>.Start Next.js by running the <code>yarn dev</code> command once all dependencies have been installed and the PHP and MySQL servers for WordPress are up and running.</p>
<h2 id="install-and-initialize-the-graphql-code-generator">Install and initialize the GraphQL code generator</h2>
<p>The GraphQL Code Generator installation requires a couple of steps. Let’s go through it:</p>
<h3 id="install-the-core-modules">Install the core modules</h3>
<p>First, we need to install the core dependencies:</p>
<div class="remark-highlight"><astro-island uid="95Bfo" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-bash&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-bash"><astro-slot>
  <code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> graphql
<span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">-D</span> @graphql-codegen/cli
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h3 id="initialize-the-code-generator">Initialize the code generator</h3>
<p>Next, we need to initialize the code generator, which will give us a config file:</p>
<div class="remark-highlight"><astro-island uid="Z261xB9" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-bash&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-bash"><astro-slot>
  <code class="language-bash"><span class="token function">yarn</span> graphql-codegen init
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>After that, the <code>init</code> script will ask us several questions about our app. Let’s use the answers as listed below:</p>
<pre><p><p>Welcome to GraphQL Code Generator! Answer few questions and we will setup everything for you.</p></p><p><p>? What type of application are you building? <em>Application built with React</em>
<br/>? Where is your schema?: (path or url) <em><a href="http://127.0.0.1/wp/graphql">http://127.0.0.1/wp/graphql</a></em>
<br/>? Where are your operations and fragments?: <em>lib/api.(js|ts)</em>
<br/>? Pick plugins: </p><em><p>TypeScript (required by other typescript plugins), TypeScript Operations (operations and
fragments)</p></em><p><br/>? Where to write the output: <em>generated/graphql.ts</em>
<br/>? Do you want to generate an introspection file? <em>Yes</em>
<br/>? How to name the config file? <em>codegen.yml</em>
<br/>? What script in package.json should run the codegen? <em>codegen</em></p><br/></p></pre>
<p>The code generator will install some additional dependencies and create a new file in our root directory, <code>codegen.yml</code>. It is a config file. If we open it, it should look roughly like this:</p>
<div class="remark-highlight"><astro-island uid="ZehKPr" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-yaml&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-yaml"><astro-slot>
  <code class="language-yaml"><span class="token comment"># codegen.yml</span>

<span class="token key atrule">overwrite</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">schema</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1/wp/graphql&quot;</span>
<span class="token key atrule">documents</span><span class="token punctuation">:</span> <span class="token string">&quot;lib/api.(js|ts)&quot;</span>
<span class="token key atrule">generates</span><span class="token punctuation">:</span>
  <span class="token key atrule">generated/graphql.ts</span><span class="token punctuation">:</span>
    <span class="token key atrule">plugins</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;typescript&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;typescript-operations&quot;</span>
  <span class="token key atrule">./graphql.schema.json</span><span class="token punctuation">:</span>
    <span class="token key atrule">plugins</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;introspection&quot;</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h2 id="turn-graphql-introspection-on-in-wp-graphql-plugin-settings">Turn GraphQL introspection ON in WP GraphQL plugin settings</h2>
<p>There is one important thing we need to update in our WordPress settings. In the bottom of the <em>WP GraphQL</em> plugin settings page, there is a ‘Public Introspection Enabled’ checkbox. <a href="https://www.wpgraphql.com/docs/security/">For security reasons, it is disabled by default</a>:</p>
<blockquote>
<p>One feature of GraphQL is Schema Introspection, which means the GraphQL Schema itself can be queried. This is a feature used by tools such as GraphiQL and others.
It’s possible that exposing the Schema publicly (in some cases) can leak information about the system that’s not intended to be known publicly.
–<cite><a href="https://www.wpgraphql.com/docs/security/">WP GraphQL documentation</a></cite></p>
</blockquote>
<p>But we need to enable it—code generators need to know our Schema to generate the types. On our dev environment, there is probably not much to worry about (according to this PR comment, introspection <a href="https://github.com/wp-graphql/wp-graphql/pull/1490#issue-715306162">should be disabled by default</a> on <em>staging</em> and <em>production</em> environments). Let’s turn introspection <strong>ON</strong> and save the changes.</p>
<img alt="Image of a settings menu with enhanced introspection checkbox" width="1171" height="424" src="/_astro/wp-graphql-tutorial-pt2-enable-introspection.8a0026b4_Z9qxtB.png" loading="lazy" decoding="async">
<h2 id="add-the-graphql-tag-plucks">Add the GraphQL Tag Plucks</h2>
<p>If we try to run the <code>yarn run codegen</code> script, we’ll still get an error: <code>Unable to find any GraphQL type definitions for the following pointers</code>. That’s because the code generator is trying to find our GraphQL queries to create type definitions, but it can’t find any. All we are pointing it to (the ‘documents’ field in our config) is a file that has a few string arguments that are recognizable as GraphQL queries by a human, but the program is not smart enough (yet). We need to give it a hand.</p>
<p>There are some rather sophisticated solutions to that, like using a custom Webpack loaders for <code>.graphql</code> files, but we’ll keep it simple (<a href="https://en.wikipedia.org/wiki/KISS_principle">and stupid, too</a>, maybe). We’ll give the code generator some hints. These are <a href="https://www.graphql-code-generator.com/docs/getting-started/documents-field#graphql-tag-pluck">multiple patterns</a> available; we’ll choose the <code>/* GraphQL */</code> comment, which we’ll put right before the opening backtick of the query string:</p>
<div class="remark-highlight"><astro-island uid="KrtJQ" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-js&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-js"><astro-slot>
  <code class="language-js"><span class="token comment">// lib/api.js</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getLatestPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">fetchAPI</span><span class="token punctuation">(</span><span class="token comment">/* GraphQL */</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"></span>
<span class="token string">    query LatestPosts {</span>
<span class="token string">      posts {</span>
<span class="token string">        nodes {</span>
<span class="token string">          title</span>
<span class="token string">          slug</span>
<span class="token string">        }</span>
<span class="token string">      }</span>
<span class="token string">    }</span>
<span class="token string">  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> data<span class="token operator">?.</span>posts<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>(I’ve noticed that after inserting the <code>/* GraphQL */</code> hint, the query string was recognized by VS Code as a proper GraphQL query and changed its color. But it might depend on the actual editor settings.)</p>
<p>This method of tagging strings that are actually GraphQL queries is being referred to as a <a href="https://www.graphql-code-generator.com/docs/getting-started/documents-field#graphql-tag-pluck">GraphQL Tag Pluck</a> – hence the header caption.</p>
<h2 id="update-the-gitignore-file">Update the <code>.gitignore</code> file</h2>
<p>When running the codegen, we will generate some files that we probably don’t want to be included in our version control. We’ll prevent that by adding these lines to <code>.gitignore</code>:</p>
<div class="remark-highlight"><astro-island uid="Z24PPDk" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-unknown&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-unknown"><astro-slot>
  <code class="language-unknown">// ...

# generated schema and types
graphql.schema.json
generated/</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h2 id="run-the-codegen-script">Run the <code>codegen</code> script</h2>
<p>Great! Everything should be set up now. Let’s try our <code>codegen</code> script.</p>
<div class="remark-highlight"><astro-island uid="2ngEQa" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-bash&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-bash"><astro-slot>
  <code class="language-bash"><span class="token function">yarn</span> run codegen
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>The very first run may take a few seconds. Hopefully, the script resolved successfully, and we can see two more (rather big) files: <code>graphql.schema.json</code> in our root directory, containing our GraphQL schema, and <code>/generated/graphql.ts</code>, containing the derived types. If we open the latter and scroll to the bottom of the file, we should see the types for queries we defined in <code>lib/api.js</code> file:</p>
<div class="remark-highlight"><astro-island uid="aFtdW" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// generated/graphql.ts</span>

<span class="token comment">//...</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">LatestPostsQueryVariables</span> <span class="token operator">=</span> Exact<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">LatestPostsQuery</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;RootQuery&quot;</span>
  posts<span class="token operator">?</span><span class="token operator">:</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span>
        __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;RootQueryToPostConnection&quot;</span>
        nodes<span class="token operator">?</span><span class="token operator">:</span>
          <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>
              <span class="token operator">|</span> <span class="token punctuation">{</span>
                  __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;Post&quot;</span>
                  title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>
                  slug<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>
                <span class="token punctuation">}</span>
              <span class="token operator">|</span> <span class="token keyword">null</span>
              <span class="token operator">|</span> <span class="token keyword">undefined</span>
            <span class="token operator">&gt;</span>
          <span class="token operator">|</span> <span class="token keyword">null</span>
          <span class="token operator">|</span> <span class="token keyword">undefined</span>
      <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token keyword">null</span>
    <span class="token operator">|</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">AllPostsWithSlugQueryVariables</span> <span class="token operator">=</span> Exact<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">AllPostsWithSlugQuery</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;RootQuery&quot;</span>
  posts<span class="token operator">?</span><span class="token operator">:</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span>
        __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;RootQueryToPostConnection&quot;</span>
        nodes<span class="token operator">?</span><span class="token operator">:</span>
          <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;Post&quot;</span><span class="token punctuation">;</span> slug<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span>
          <span class="token operator">|</span> <span class="token keyword">null</span>
          <span class="token operator">|</span> <span class="token keyword">undefined</span>
      <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token keyword">null</span>
    <span class="token operator">|</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">PostQueryVariables</span> <span class="token operator">=</span> Exact<span class="token operator">&lt;</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> Scalars<span class="token punctuation">[</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">PostQuery</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;RootQuery&quot;</span>
  post<span class="token operator">?</span><span class="token operator">:</span>
    <span class="token operator">|</span> <span class="token punctuation">{</span>
        __typename<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&quot;Post&quot;</span>
        content<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>
        date<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>
        title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>
      <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token keyword">null</span>
    <span class="token operator">|</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h2 id="utilize-the-types-in-our-api">Utilize the types in our api</h2>
<p>For simplicity’s sake, we left the <code>/lib/api.js</code> a plain javascript file in the first part of the tutorial. Now, it’s the time to take a step forward and convert it to TypeScript—simply by changing its extension: <code>mv lib/api.js lib/api.ts</code>. The compiler may have some complaints (about parameters without types) —don’t worry, we’ll fix that soon.</p>
<h3 id="import-and-arrange-types-for-our-queries">Import and arrange types for our queries</h3>
<p>First, let’s import our generated types. Also, let’s separate them into two basic categories: the <code>Query</code> types and query variables, which we put inside the general <code>Options</code> type.</p>
<div class="remark-highlight"><astro-island uid="Z1nnqcB" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// lib/api.ts</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  LatestPostsQueryVariables<span class="token punctuation">,</span>
  LatestPostsQuery<span class="token punctuation">,</span>
  AllPostsWithSlugQueryVariables<span class="token punctuation">,</span>
  AllPostsWithSlugQuery<span class="token punctuation">,</span>
  PostQueryVariables<span class="token punctuation">,</span>
  PostQuery<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../generated/graphql&quot;</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token operator">=</span> LatestPostsQuery <span class="token operator">|</span> AllPostsWithSlugQuery <span class="token operator">|</span> PostQuery

<span class="token keyword">type</span> <span class="token class-name">Options</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  variables<span class="token operator">?</span><span class="token operator">:</span> LatestPostsQueryVariables <span class="token operator">|</span> AllPostsWithSlugQueryVariables <span class="token operator">|</span> PostQueryVariables
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">API_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1/wp/graphql&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchAPI</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token punctuation">{</span> variables <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h3 id="add-types-to-the-fetchapi-function">Add types to the <code>FetchApi</code> function</h3>
<p>Let’s type out <code>fetchAPI</code> function. It will accept a generic type <code>T</code> with the constraint that it is a <code>T</code> of the <code>Query</code> type: <code>&lt;T extends Query&gt;</code>. The function returns that <code>T</code> type wrapped in a Promise: <code>Promise&lt;T&gt;</code>.</p>
<p>Also, let’s add types to its parameters: the <code>query</code> is simply a <code>string</code>, and the object exposing the variables property will take the <code>Options</code> type. We’ll also give it a default argument—an empty object <code>{}</code>.</p>
<div class="remark-highlight"><astro-island uid="lpcOY" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// lib/api.ts</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  LatestPostsQueryVariables<span class="token punctuation">,</span>
  LatestPostsQuery<span class="token punctuation">,</span>
  AllPostsWithSlugQueryVariables<span class="token punctuation">,</span>
  AllPostsWithSlugQuery<span class="token punctuation">,</span>
  PostQueryVariables<span class="token punctuation">,</span>
  PostQuery<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../generated/graphql&quot;</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token operator">=</span> LatestPostsQuery <span class="token operator">|</span> AllPostsWithSlugQuery <span class="token operator">|</span> PostQuery

<span class="token keyword">type</span> <span class="token class-name">Options</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  variables<span class="token operator">?</span><span class="token operator">:</span> LatestPostsQueryVariables <span class="token operator">|</span> AllPostsWithSlugQueryVariables <span class="token operator">|</span> PostQueryVariables
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">API_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1/wp/graphql&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fetchAPI</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Query<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> variables <span class="token punctuation">}</span><span class="token operator">:</span> Options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span> <span class="token punctuation">}</span>

  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">API_URL</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">,</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">,</span> variables <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error details&quot;</span><span class="token punctuation">,</span> query<span class="token punctuation">,</span> variables<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to fetch API&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> json<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h3 id="add-types-for-our-queries">Add types for our queries</h3>
<p>Our <code>fetchAPI</code> function accepts a generic type <code>&lt;T&gt;</code>. In the specialized querying functions, we will replace the generic type with one of the concrete types we imported beforehand.</p>
<p>The <code>getPost</code> function also accepts a query variables object as an argument. Let’s give it the imported <code>PostQueryVariables</code> type.</p>
<p>Our <code>api.ts</code> file should look like this (hopefully, no TypeScript complaints):</p>
<div class="remark-highlight"><astro-island uid="1NFs5y" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// lib/api.ts</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  LatestPostsQueryVariables<span class="token punctuation">,</span>
  LatestPostsQuery<span class="token punctuation">,</span>
  AllPostsWithSlugQueryVariables<span class="token punctuation">,</span>
  AllPostsWithSlugQuery<span class="token punctuation">,</span>
  PostQueryVariables<span class="token punctuation">,</span>
  PostQuery<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../generated/graphql&quot;</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token operator">=</span> LatestPostsQuery <span class="token operator">|</span> AllPostsWithSlugQuery <span class="token operator">|</span> PostQuery

<span class="token keyword">type</span> <span class="token class-name">Options</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  variables<span class="token operator">?</span><span class="token operator">:</span> LatestPostsQueryVariables <span class="token operator">|</span> AllPostsWithSlugQueryVariables <span class="token operator">|</span> PostQueryVariables
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">API_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1/wp/graphql&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fetchAPI</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Query<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> variables <span class="token punctuation">}</span><span class="token operator">:</span> Options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span> <span class="token punctuation">}</span>

  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">API_URL</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">,</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">,</span> variables <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error details&quot;</span><span class="token punctuation">,</span> query<span class="token punctuation">,</span> variables<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to fetch API&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> json<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getLatestPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">fetchAPI</span><span class="token generic class-name"><span class="token operator">&lt;</span>LatestPostsQuery<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token comment">/* GraphQL */</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"></span>
<span class="token string">    query LatestPosts {</span>
<span class="token string">      posts {</span>
<span class="token string">        nodes {</span>
<span class="token string">          title</span>
<span class="token string">          slug</span>
<span class="token string">        }</span>
<span class="token string">      }</span>
<span class="token string">    }</span>
<span class="token string">  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> data<span class="token operator">?.</span>posts
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAllPostsWithSlug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data<span class="token operator">:</span> AllPostsWithSlugQuery <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">fetchAPI</span><span class="token generic class-name"><span class="token operator">&lt;</span>AllPostsWithSlugQuery<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token comment">/* GraphQL */</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"></span>
<span class="token string">    query AllPostsWithSlug {</span>
<span class="token string">      posts(first: 100) {</span>
<span class="token string">        nodes {</span>
<span class="token string">          slug</span>
<span class="token string">        }</span>
<span class="token string">      }</span>
<span class="token string">    }</span>
<span class="token string">  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> data<span class="token operator">?.</span>posts
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getPost</span><span class="token punctuation">(</span>slug<span class="token operator">:</span> PostQueryVariables<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data<span class="token operator">:</span> PostQuery <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">fetchAPI</span><span class="token generic class-name"><span class="token operator">&lt;</span>PostQuery<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token comment">/* GraphQL */</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"></span>
<span class="token string">      query Post($id: ID!) {</span>
<span class="token string">        post(id: $id, idType: SLUG) {</span>
<span class="token string">          content</span>
<span class="token string">          date</span>
<span class="token string">          title</span>
<span class="token string">        }</span>
<span class="token string">      }</span>
<span class="token string">    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      variables<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> slug<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  <span class="token keyword">return</span> data<span class="token operator">?.</span>post
<span class="token punctuation">}</span>
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<h2 id="utilize-the-types-in-our-templates">Utilize the types in our templates</h2>
<p>Great! We already have typed the data we’re querying in our api. But the page templates don’t know the types yet. We need to take one last step.</p>
<h3 id="import-and-apply-our-types">Import and apply our types</h3>
<p>Let’s import <code>InferGetStaticPropsType</code> type utility from the “next” module. Then, we’ll simply use that utility to infer the return type of the <code>getStaticProps</code> function:</p>
<div class="remark-highlight"><astro-island uid="Z2m8j31" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// pages/index.tsx</span>

<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&quot;next/link&quot;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> InferGetStaticPropsType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getLatestPosts <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./../lib/api&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> latestPosts <span class="token punctuation">}</span><span class="token operator">:</span> InferGetStaticPropsType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> getStaticProps<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> nodes <span class="token punctuation">}</span> <span class="token operator">=</span> latestPosts

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Our WordPress<span class="token operator">/</span>Next app Home Page<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>nodes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>node <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>node<span class="token punctuation">.</span>slug<span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;posts/&quot;</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>slug<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>node<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> latestPosts <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getLatestPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      latestPosts<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Home
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>Now, we should be able to see the inferred type when hovering over the <code>LatestPosts</code> prop:</p>
<img alt="Image of the type 'tooltip' appearing on variable hover in VS Code" width="657" height="266" src="/_astro/wp-graphql-tutorial-pt2-inferred-type.f2e9d5b4_Z1MUccc.png" loading="lazy" decoding="async">
<h3 id="update-our-component-to-make-typescript-happy">Update our component to make TypeScript happy</h3>
<p>But the TypeScript compiler is not happy! It is spawning wavy red underlines everywhere!</p>
<p>Don’t panic. TypeScript in strict mode (which is the default for Next.js v12) can be pretty harsh. The issue is that very few of the properties in our inferred <code>LatestPosts</code> are guaranteed. Therefore, we need to update our code so it won’t crash at runtime with the well known <code>Uncaught TypeError: Cannot read property &#39;X&#39; of undefined/null</code> error.</p>
<p>Since our component is simple, all we’ll need are <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator">nullish coalescing</a> (<code>??</code>) and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">optional chaining</a> (<code>?.</code>) operators:</p>
<div class="remark-highlight"><astro-island uid="Zd1hy3" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// pages/index.tsx</span>

<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&quot;next/link&quot;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> InferGetStaticPropsType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getLatestPosts <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./../lib/api&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> latestPosts <span class="token punctuation">}</span><span class="token operator">:</span> InferGetStaticPropsType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> getStaticProps<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> nodes <span class="token punctuation">}</span> <span class="token operator">=</span> latestPosts <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Our Wordpress<span class="token operator">/</span>Next app Home Page<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>nodes<span class="token operator">?.</span><span class="token function">map</span><span class="token punctuation">(</span>node <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>node<span class="token operator">?.</span>slug<span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;posts/&quot;</span> <span class="token operator">+</span> node<span class="token operator">?.</span>slug<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>node<span class="token operator">?.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> latestPosts <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getLatestPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      latestPosts<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Home
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>Now, TypeScript should be happy.</p>
<h3 id="the-slugtsx-template">The <code>[slug].tsx</code> template</h3>
<p>In the <code>[slug].tsx</code> file, we will need to import one more utility type: <code>GetStaticPropsContext</code>. It will be used for the arguments passed in <code>getStaticProps</code> function. We’re passing in the object literal (for simplicity; it is probably a good practice to extract that into a separate type) with the <code>slug</code> property of type <code>string</code>.</p>
<p>We are also probably getting a lot of TypeScript errors due to unsafe property chaining. Let’s fix it. As before, we’ll use nullish coalescing and optional chaining:</p>
<div class="remark-highlight"><astro-island uid="Z1GUVnq" component-url="/_astro/Code.f793ae0c.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{&quot;className&quot;:[0,&quot;language-typescript&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Code&quot;,&quot;value&quot;:true}" await-children=""><div class="relative group"><pre class="language-typescript"><astro-slot>
  <code class="language-typescript"><span class="token comment">// pages/posts/[slug].tsx</span>

<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&quot;next/link&quot;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> GetStaticPropsContext<span class="token punctuation">,</span> InferGetStaticPropsType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getAllPostsWithSlug<span class="token punctuation">,</span> getPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../lib/api&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Post</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> post <span class="token punctuation">}</span><span class="token operator">:</span> InferGetStaticPropsType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> getStaticProps<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> title<span class="token punctuation">,</span> date<span class="token punctuation">,</span> content <span class="token punctuation">}</span> <span class="token operator">=</span> post <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>Back to Homepage<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>date <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>time dateTime<span class="token operator">=</span><span class="token punctuation">{</span>date<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>time<span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>div dangerouslySetInnerHTML<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> __html<span class="token operator">:</span> content <span class="token operator">??</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span>context<span class="token operator">:</span> GetStaticPropsContext<span class="token operator">&lt;</span><span class="token punctuation">{</span> slug<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> slug <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>params<span class="token operator">?.</span>slug<span class="token punctuation">)</span>
  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPost</span><span class="token punctuation">(</span>slug<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      post<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> allPostsWithSlug <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllPostsWithSlug</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    paths<span class="token operator">:</span> allPostsWithSlug<span class="token operator">?.</span>nodes<span class="token operator">?.</span><span class="token function">map</span><span class="token punctuation">(</span>node <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token operator">?.</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    fallback<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Post
</code>
</astro-slot></pre><button class="text-sm text-primary border dark:border-gray-800 dark:bg-primary dark:bg-primary rounded absolute top-4 right-4 px-2 opacity-0 group-hover:opacity-100 transition-opacity">Copy</button></div></astro-island></div>
<p>Well, that’s all for now. I hope you’ve learned something useful while reading this. You can check the final code in my <a href="https://github.com/HynekS/wp-next-graphql-tutorial_frontend/tree/part-02">github repo</a>.</p>
<p>👍 Enjoy!</p>
      <p class="text-xs">
            last modified <span> </span><span>yesterday</span>
          </p>
      <hr>
      <p class="text-sm">
        If you find anything in this post that should be improved (either
        factually or linguistically), feel free to 
        <a href="#" rel="noopener noreferrer" target="_blank">
          edit it on Github TODO add the actual link!
        </a>
        .
      </p>
    </article>
  </main>
  <astro-island uid="Z1Y60Dj" component-url="/_astro/ScrollToTop.3e47395f.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;ScrollToTop&quot;,&quot;value&quot;:true}" await-children=""><style>
  @keyframes bounce-reverse {
    0%, 100% {
      transform: translateY(0);
      animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
    }
    50% {
      transform: translateY(-25%);
      animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
    }
  }
  </style><button class="fixed bottom-6 right-10 bg-primary origin-center transition-transform shadow-xl rounded-full text-primary flex items-center justify-center border-2 p-3 focus:outline-none focus:ring-0 dark:border-slate-600 scale-0 false" aria-label="Scroll to top"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg></button></astro-island>
  <script>(self.Astro=self.Astro||{}).only=t=>{(async()=>await(await t())())()},window.dispatchEvent(new Event("astro:only"));</script><astro-island uid="5YIQ3" component-url="/_astro/Lightbox.8c55f423.js" component-export="default" renderer-url="/_astro/client.c257378c.js" props="{}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Lightbox&quot;,&quot;value&quot;:&quot;preact&quot;}"></astro-island>

    
<div class="flex justify-center py-8">
    <footer class="max-w-prose">
      <div class="flex gap-4 justify-center mb-4 text-[#a485e6] dark:text-gray-400">
        <a class="block transition-colors hover:text-[var(--color-primary)]" href="https://github.com/HynekS" rel="noopener noreferrer" target="__blank" aria-label="Link to my Github profile">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
    <path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path>
  </svg>
        </a>
        <a class="block transition-colors hover:text-[var(--color-primary)]" href="https://www.linkedin.com/in/hynek-%C5%A1v%C3%A1cha-829387103/" rel="noopener noreferrer" target="__blank" aria-label="Link to my LinkedIn profile">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
  <path d="M19 0H5a5 5 0 0 0-5 5v14a5 5 0 0 0 5 5h14a5 5 0 0 0 5-5V5a5 5 0 0 0-5-5zM8 19H5V8h3v11zM6.5 6.732c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zM20 19h-3v-5.604c0-3.368-4-3.113-4 0V19h-3V8h3v1.765c1.396-2.586 7-2.777 7 2.476V19z"></path>
</svg>
        </a>
        <a class="block transition-colors hover:text-[var(--color-primary)]" href="https://stackoverflow.com/users/8252267/hyneks" rel="noopener noreferrer" target="__blank" aria-label="Link to my Stack Overflow profile">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="12 12 90 90" fill="currentColor" class="w-6 h-6">
  <path class="st0" d="M84.4 93.8V70.6h7.7v30.9H22.6V70.6h7.7v23.2z"></path><path class="st1" d="M38.8 68.4l37.8 7.9 1.6-7.6-37.8-7.9-1.6 7.6zm5-18l35 16.3 3.2-7-35-16.4-3.2 7.1zm9.7-17.2l29.7 24.7 4.9-5.9-29.7-24.7-4.9 5.9zm19.2-18.3l-6.2 4.6 23 31 6.2-4.6-23-31zM38 86h38.6v-7.7H38V86z"></path></svg>
        </a>
      </div>
      <span class="text-sm font-mono px-4">© 2019–<span id="currentYear">present</span> Hynek Svacha</span>
    </footer>
  </div>
  </body></html>